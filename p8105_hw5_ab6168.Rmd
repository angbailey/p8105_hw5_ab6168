---
title: "p8105_hw5_ab6168"
author: "Angelica Bailey"
date: "2025-11-05"
output: github_document
---

```{r}
library(tidyverse)
```


## Problem 1

Writing function:
```{r}
# n : number of people in the group
# return TRUE if at least two people share a birthday, FALSE otherwise

birthday_match = function(n) {
  #randomly drawing n birthdays from 1 to 365
  birthdays = sample(1:365, size = n, replace = TRUE) 
  
  return(any(duplicated(birthdays)))
}

```


Creating data frame
```{r}
simulation_results = data.frame(
  group_size = 2:50,
  probability = numeric(length(group_size)) # initialize column of zeros
)
```

Running simulations
```{r}
for (i in 1:nrow(simulation_results)) {
  
  # Get the group size 'n' for the current row
  n = simulation_results$group_size[i]
  
  # Replicate the function 10,000 times for this 'n'
  # This creates a vector of 10,000 TRUE/FALSE values
  trials = replicate(10000, birthday_match(n))
  
  # Calculate the probability by finding the mean
  # R treats TRUE as 1 and FALSE as 0, so mean()
  # gives us the proportion of TRUEs (i.e., the probability).
  simulation_results$probability[i] = mean(trials)
}
```

Making plot
```{r}
ggplot(simulation_results, aes(x = group_size, y = probability)) +
  geom_line(color = "blue") +
  geom_point(color = "blue") +
  labs(
    title = "The Birthday Problem: Simulation Results",
    subtitle = paste("Based on", n_sims, "trials per group size"),
    x = "Number of People in Group",
    y = "Probability of at Least One Shared Birthday"
  )
```



## Problem 2




